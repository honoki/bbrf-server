{
    "views": {
    "domains": {
      "map": "function (doc) {\n  if(doc.type == \"domain\")\n  emit(doc.program, doc._id);\n}",
      "reduce": "_count"
    },
    "ips": {
      "map": "function (doc) {\n  if(doc.type == \"ip\")\n  emit(doc.program, doc._id);\n}",
      "reduce": "_count"
    },
    "programs": {
      "map": "function (doc) {\n  if(doc.type == \"program\")\n  emit(doc.disabled, doc.inscope.length, 1);\n}",
      "reduce": "_count"
    },
    "domains_resolved": {
      "map": "function (doc) {\n  if(doc.type == \"domain\" && doc.ips.length > 0)\n  emit(doc.program, doc._id);\n}",
      "reduce": "_count"
    },
    "domains_unresolved": {
      "map": "function (doc) {\n  if(doc.type == \"domain\" && (!doc.hasOwnProperty(\"ips\") || doc.ips.length === 0))\n  emit(doc.program, doc._id);\n}",
      "reduce": "_count"
    },
    "taskexecutions": {
      "map": "function (doc) {\n  if(doc.type == \"taskexecution\")\n  emit([doc.program, doc.task, doc.timestamp], doc.output);\n}"
    },
    "alerts": {
      "map": "function (doc) {\n  if(doc.type == \"alert\")\n  emit(doc.program, doc.message);\n}"
    },
    "agents": {
      "map": "function (doc) {\n  if(doc.type == \"agent\")\n  emit( doc.name, 1);\n}"
    },
    "urls_by_program": {
      "map": "function (doc) {\n  if (doc.type == \"url\")\n      emit(doc.program, [doc._id, doc.status, doc.content_length, doc.query])\n}",
      "reduce": "_count"
    },
    "urls_by_hostname": {
      "map": "function (doc) {\n  if (doc.type == \"url\")\n      emit(doc.hostname, [doc._id, doc.status, doc.content_length, doc.query])\n}",
      "reduce": "_count"
    },
    "scope": {
      "map": "function (doc) {\n  if(doc.type == \"program\") {\n    if(doc.inscope.length > 0) {\n      doc.inscope.forEach(function(scope) {\n        emit([!doc.disabled, \"IN\", scope], doc._id)\n      });\n    }\n    if(doc.outscope.length > 0) {\n      doc.outscope.forEach(function(scope) {\n        emit([!doc.disabled, \"OUT\", scope], doc._id)\n      });\n    }\n  }\n  \n}"
    },
    "search_tags": {
      "map": "function (doc) {\n  if(doc.tags) {\n    for(prop in doc.tags) {\n      if(Array.isArray(doc.tags[prop])) {\n        for(val in doc.tags[prop]) {\n          emit([prop, doc.tags[prop][val]], [doc.type, doc._id, doc.program ? doc.program : doc._id])\n        }\n      } else {\n        emit([prop, doc.tags[prop]], [doc.type, doc._id, doc.program ? doc.program : doc._id])\n      }\n    }\n    \n  }\n  if(doc.ips && doc.ips.length > 0) {\n    for(ip in doc.ips) {\n        if(doc.ips[ip].length > 0) emit(['ip', doc.ips[ip]], [doc.type, doc._id, doc.program])\n    }\n  }\n  if(doc.domains) {\n      for(domain in doc.domains) {\n        if(doc.domains[domain].length > 0) emit(['domain', doc.domains[domain]], [doc.type, doc._id, doc.program])\n      }\n  }\n  if(doc.type == 'service') {\n    emit(['ip', doc.ip], [doc.type, doc._id, doc.program])\n    emit(['service', doc.service], [doc.type, doc._id, doc.program])\n    emit(['port', doc.port], [doc.type, doc._id, doc.program])\n  }\n  \n  if(doc.source) {\n    emit(['source', doc.source], [doc.type, doc._id, doc.program])\n  }\n}"
    },
    "services": {
      "map": "function (doc) {\n  if(doc.type == \"service\")\n  emit(doc.program, doc._id);\n}",
      "reduce": "_count"
    },
    "tags": {
      "map": "function (doc) {\n  if(doc.tags) {\n    for(tag in doc.tags) {\n      if(Array.isArray(doc.tags[tag])) {\n        for(val in doc.tags[tag]) {\n          emit(tag, [doc._id, doc.tags[tag][val], doc.program ? doc.program : doc._id], 1)\n        }\n      } else {\n        emit(tag, [doc._id, doc.tags[tag], doc.program ? doc.program : doc._id], 1)\n      }\n    }\n  }\n}"
    },
    "ips_no_cdn": {
      "map": "function (doc) {\n  if(doc.type == \"ip\" && !(doc.tags && doc.tags.cdn))\n  emit(doc.program, doc._id);\n}"
    }
  }
}